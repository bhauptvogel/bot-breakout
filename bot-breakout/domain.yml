version: '3.1'
intents:
- user_asks_about_wellbeing
- user_wants_to_leave
- user_needs_hint
- overview_of_the_state
- user_guesses_murderer
- scene_investigation
- information_about_character
- motive_of_character
- access_to_rollercoaster
- EXTERNAL_reminder
- cabin_investigation
- guess_cabin_pin

entities:
- object
- person
- information
- cabin_password
- cabin_guess
- cabin_number_guess
- cabin_open

slots:
  data:
    type: rasa.shared.core.slots.AnySlot
    initial_value: null
    mappings:
    - type: custom
  cabin_password:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: cabin_password
  cabin_guess:
    type: float
    mappings:
    - type: from_entity
      entity: cabin_guess
  cabin_number_guess:
    type: bool
    mappings:
    - type: from_entity
      entity: cabin_number_guess
  cabin_open:
    type: bool
    initial_value: false
    mappings:
    - type: from_entity
      entity: cabin_open

forms:
  simple_cabin_form:
    required_slots:
      - cabin_password

responses:
  utter_you_cannot_leave:
  - text: You can’t leave before the police arrive in a few minutes! We need to find hints together, so they don’t think we two did it. Should we investigate or talk?
  - text: This is not possible! The murderer could still be walking around, we should wait until the police arrive in a few minutes. I think we should investigate the situation more.
  utter_cabin_entry:
  - text: "It has two seats, as ours did. On the seat closer to us and closer to the themed area is the female corpse. She is covered in blood and a note is pinned to her chest. I don’t see why and how she died... The floor also looks messy. I see something in the puddles. It's a knife! It's strange to grab in blood, but I get it out. I could take a closer look at it."
  utter_cabin_text:
  - condition:
        - type: slot
          name: cabin_open
          value: true
    text: "It has two seats, as ours did. On the seat closer to us and closer to the themed area is the female corpse. She is covered in blood and a note is pinned to her chest. I don’t see why and how she died... The floor also looks messy. I see something in the puddles. It's a knife! It's strange to grab in blood, but I get it out. I could take a closer look at it."
  - condition:
        - type: slot
          name: cabin_open
          value: false
    text: "We are now standing in front of the train cabin with the dead body. But Damn... the door is locked, and I can't get in. All cabins are locked with a 3-digit pin code. I set those after a rough workday... I don't know the solution but I work with a specific system. I subtract the fourth prime number from the cabin number, added 2 and divide it by 2. I think the cabin number of this cabin is 686. Can you help me find the right pin code to enter the cabin? Just tell me the 3-digit pin code I should try!"
actions:
- action_overview_of_the_state
- action_scene_investigation
- action_character_investigation
- action_tell_motive
- action_access_to_roller_coaster
- action_set_reminder
- action_react_to_reminder
- action_user_guess
- validate_simple_cabin_form
- action_cabin_end
- utter_ask_cabin_password
- action_give_hint
session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true

